<!DOCTYPE HTML>
<html>
<head>
<title>Ubiquity weather command - Allan Espinosa</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1,
      maximum-scale=1">
<link rel="stylesheet" type="text/css" href="../css/main.css" />
</head>
<body>

<header>
  <h1> Allan Espinosa </h1>
</header>
<nav>
  <ul>
    <li><a href="../">Home</a></li>
    <li><a href="../blog/">Blog</a></li>
    <li><a href="../presentations.html">Publications</a></li>
    <li><a href="../contact.html">Contact</a></li>
  </ul>
</nav>
<main>
<article class="post">
  <h1>Ubiquity weather command</h1>
  <p>2008 September  7</p>

  <section>
    <p><a href="http://labs.mozilla.com/2008/08/introducing-ubiquity/">Ubiquity</a> from Mozilla labs features a nice command for querying the weather. It creates a query to the Google Weather service and returns the result. But with Google’s location/ IP dependent search results you can get the weather information in various languages depending where you conduct the search. For example if your language preference is Filipino (politically correct) or Tagalog (ISO language standard code) TL, you get the results in the corresponding language and in the unit standard used in the area.</p>
<p>But as a metric thinking type of guy, I hate it when Google gives me the results in Fahrenheit! I did some tweaking to get the weather in the metric system while using the English language.Â  The simple solution is to use the EN-UK language code. Simply edit your ~/.mozilla/[profile_name]/extentions/ubiquity@labs.mozilla.com/chrome/content/builtincmds.js and modify the command “weather”:</p>
<pre><code>&lt;code&gt;
CmdUtils.CreateCommand({
  name: &quot;weather&quot;,
  takes: {&quot;location&quot;: noun_arb_text},
  icon: &quot;http://www.wunderground.com/favicon.ico&quot;,
  description: &quot;Checks the weather for a given location.&quot;,
  help: &quot;Try issuing &quot;weather chicago&quot;.  It works with zip-codes, too.&quot;,
  execute: function( directObj ) {
    var location = directObj.text;
    var url = &quot;http://www.wunderground.com/cgi-bin/findweather/getForecast?query=&quot;;
    url += escape( location );

    Utils.openUrlInBrowser( url );
  },

  preview: function( pblock, directObj ) {
    var location = directObj.text;
    if( location.length &lt; 1 ) {
      pblock.innerHTML = &quot;Gets the weather for a zip code/city.&quot;;
      return;
    }

    var url = &quot;http://www.google.com/ig/api&quot;;
    jQuery.get( url, {weather: location, hl: &quot;EN-GB&quot;}, function(xml) {
      var el = jQuery(xml).find(&quot;current_conditions&quot;);
      if( el.length == 0 ) return;

      var condition = el.find(&quot;condition&quot;).attr(&quot;data&quot;);

      var weatherId = WEATHER_TYPES.indexOf( condition.toLowerCase() );
      var imgSrc = &quot;http://l.yimg.com/us.yimg.com/i/us/nws/weather/gr/&quot;;
      imgSrc += weatherId + &quot;d.png&quot;;

      var weather = {
        condition: condition,
        temp: el.find(&quot;temp_c&quot;).attr(&quot;data&quot;),
        humidity: el.find(&quot;humidity&quot;).attr(&quot;data&quot;),
        wind: el.find(&quot;wind_condition&quot;).attr(&quot;data&quot;),
        img: imgSrc
      };

      weather[&quot;img&quot;] = imgSrc;

      var html = CmdUtils.renderTemplate( {file:&quot;weather.html&quot;}, {w:weather}
                                        );

      jQuery(pblock).html( html );
      }, &quot;xml&quot;);
  }
});&lt;/code&gt;</code></pre>
  </section>
</article>

</main>

<div id="others">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Sidebar -->
  <ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-8408299806266445" data-ad-slot="7051680217"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>

<footer>
  Last updated 2021 February 11
</footer>

</body>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
     Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58996975-1', 'auto');
    ga('send', 'pageview');

</script>

</html>

<!-- vim:set sts=4 -->
